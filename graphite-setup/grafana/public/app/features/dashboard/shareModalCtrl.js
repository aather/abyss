/*! grafana - v2.5.0 - 2015-10-28
 * Copyright (c) 2015 Torkel Ã–degaard; Licensed Apache-2.0 */

define(["angular","lodash","require","config"],function(a,b,c,d){"use strict";var e=a.module("grafana.controllers");e.controller("ShareModalCtrl",["$scope","$rootScope","$location","$timeout","timeSrv","$element","templateSrv","linkSrv",function(b,c,d,e,f,g,h,i){b.options={forCurrent:!0,includeTemplateVars:!0,theme:"current"},b.editor={index:0},b.init=function(){b.modeSharePanel=b.panel?!0:!1,b.tabs=[{title:"Link",src:"shareLink.html"}],b.modeSharePanel?(b.modalTitle="Share Panel",b.tabs.push({title:"Embed",src:"shareEmbed.html"})):b.modalTitle="Share Dashboard",b.dashboardMeta.isSnapshot||b.tabs.push({title:"Snapshot sharing",src:"shareSnapshot.html"}),b.buildUrl()},b.buildUrl=function(){var c=d.absUrl(),e=c.indexOf("?");-1!==e&&(c=c.substring(0,e));var g=a.copy(d.search()),j=f.timeRange();g.from=j.from.valueOf(),g.to=j.to.valueOf(),b.options.includeTemplateVars&&h.fillVariableValuesForUrl(g),b.options.forCurrent||(delete g.from,delete g.to),"current"!==b.options.theme&&(g.theme=b.options.theme),b.modeSharePanel?(g.panelId=b.panel.id,g.fullscreen=!0):(delete g.panelId,delete g.fullscreen),b.shareUrl=i.addParamsToUrl(c,g);var k=b.shareUrl;k=k.replace("/dashboard/","/dashboard-solo/"),b.iframeHtml='<iframe src="'+k+'" width="450" height="200" frameborder="0"></iframe>',b.imageUrl=k.replace("/dashboard-solo/","/render/dashboard-solo/"),b.imageUrl+="&width=1000",b.imageUrl+="&height=500"}}]),e.directive("clipboardButton",function(){return function(a,b){c(["ZeroClipboard"],function(a){a.config({swfPath:d.appSubUrl+"/public/vendor/ZeroClipboard.swf"}),new a(b[0])})}})});