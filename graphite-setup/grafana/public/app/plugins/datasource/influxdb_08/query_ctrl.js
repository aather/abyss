/*! grafana - v2.5.0 - 2015-10-28
 * Copyright (c) 2015 Torkel Ã–degaard; Licensed Apache-2.0 */

define(["angular"],function(a){"use strict";var b=a.module("grafana.controllers"),c=null;b.controller("InfluxQueryCtrl_08",["$scope","$timeout",function(a,b){a.init=function(){var c=a.target;c["function"]=c["function"]||"mean",c.column=c.column||"value",c.condition_value&&(c.condition=c.condition_key+" "+c.condition_op+" "+c.condition_value,delete c.condition_key,delete c.condition_op,delete c.condition_value),c.groupby_field_add===!1&&(c.groupby_field="",delete c.groupby_field_add),a.functions=["count","mean","sum","min","max","mode","distinct","median","derivative","stddev","first","last","difference"],a.operators=["=","=~",">","<","!~","<>"],a.oldSeries=c.series,a.$on("typeahead-updated",function(){b(a.get_data)})},a.toggleQueryMode=function(){a.target.rawQuery=!a.target.rawQuery},a.seriesBlur=function(){a.oldSeries!==a.target.series&&(a.oldSeries=a.target.series,a.columnList=null,a.get_data())},a.changeFunction=function(b){a.target["function"]=b,a.get_data()},a.listColumns=function(b,c){return a.columnList?a.columnList:void a.$apply(function(){a.datasource.listColumns(a.target.series).then(function(b){a.columnList=b,c(b)})})},a.listSeries=function(b,d){return""===b?c:(c=[],void a.datasource.listSeries(b).then(function(a){c=a,d(c)}))},a.init()}])});