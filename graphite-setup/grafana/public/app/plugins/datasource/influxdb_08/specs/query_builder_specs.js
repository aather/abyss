/*! grafana - v2.5.0 - 2015-10-28
 * Copyright (c) 2015 Torkel Ã–degaard; Licensed Apache-2.0 */

define(["require","exports","app/plugins/datasource/influxdb_08/query_builder","test/lib/common"],function(a,b,c,d){d.describe("InfluxQueryBuilder",function(){d.describe("series with conditon and group by",function(){var a=new c({series:"google.test",column:"value","function":"mean",condition:"code=1",groupby_field:"code"}),b=a.build();d.it("should generate correct query",function(){d.expect(b).to.be('select code, mean(value) from "google.test" where $timeFilter and code=1 group by time($interval), code order asc')}),d.it("should expose groupByFiled",function(){d.expect(a.groupByField).to.be("code")})}),d.describe("series with fill and minimum group by time",function(){var a=new c({series:"google.test",column:"value","function":"mean",fill:"0"}),b=a.build();d.it("should generate correct query",function(){d.expect(b).to.be('select mean(value) from "google.test" where $timeFilter group by time($interval) fill(0) order asc')})}),d.describe("merge function detection",function(){d.it("should not quote wrap regex merged series",function(){var a=new c({series:"merge(/^google.test/)",column:"value","function":"mean"}),b=a.build();d.expect(b).to.be("select mean(value) from merge(/^google.test/) where $timeFilter group by time($interval) order asc")}),d.it('should quote wrap series names that start with "merge"',function(){var a=new c({series:"merge.google.test",column:"value","function":"mean"}),b=a.build();d.expect(b).to.be('select mean(value) from "merge.google.test" where $timeFilter group by time($interval) order asc')})})})});