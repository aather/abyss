/*! grafana - v2.5.0 - 2015-10-28
 * Copyright (c) 2015 Torkel Ã–degaard; Licensed Apache-2.0 */

define(["lodash","kbn"],function(a,b){"use strict";function c(a){this.datapoints=a.datapoints,this.label=a.alias,this.id=a.alias,this.alias=a.alias,this.color=a.color,this.valueFormater=b.valueFormats.none,this.stats={},this.legend=!0}function d(a,c){if(!a)return!1;if("/"===a[0]){var d=b.stringToJsRegex(a);return null!=c.match(d)}return a===c}function e(a){return 0===a?.001:a/10}return c.prototype.applySeriesOverrides=function(a){this.lines={},this.points={},this.bars={},this.yaxis=1,this.zindex=0,delete this.stack;for(var b=0;b<a.length;b++){var c=a[b];d(c.alias,this.alias)&&(void 0!==c.lines&&(this.lines.show=c.lines),void 0!==c.points&&(this.points.show=c.points),void 0!==c.bars&&(this.bars.show=c.bars),void 0!==c.fill&&(this.lines.fill=e(c.fill)),void 0!==c.stack&&(this.stack=c.stack),void 0!==c.linewidth&&(this.lines.lineWidth=c.linewidth),void 0!==c.pointradius&&(this.points.radius=c.pointradius),void 0!==c.steppedLine&&(this.lines.steps=c.steppedLine),void 0!==c.zindex&&(this.zindex=c.zindex),void 0!==c.fillBelowTo&&(this.fillBelowTo=c.fillBelowTo),void 0!==c.color&&(this.color=c.color),void 0!==c.transform&&(this.transform=c.transform),void 0!==c.legend&&(this.legend=c.legend),void 0!==c.yaxis&&(this.yaxis=c.yaxis))}},c.prototype.getFlotPairs=function(b){var c=[];this.stats.total=0,this.stats.max=-Number.MAX_VALUE,this.stats.min=Number.MAX_VALUE,this.stats.avg=null,this.stats.current=null,this.allIsNull=!0;for(var d,e,f="connected"===b,g="null as zero"===b,h=0;h<this.datapoints.length;h++){if(e=this.datapoints[h][0],d=this.datapoints[h][1],null===e){if(f)continue;g&&(e=0)}null!==e&&(a.isNumber(e)&&(this.stats.total+=e,this.allIsNull=!1),e>this.stats.max&&(this.stats.max=e),e<this.stats.min&&(this.stats.min=e)),c.push([d,e])}return this.datapoints.length>=2&&(this.stats.timeStep=this.datapoints[1][1]-this.datapoints[0][1]),this.stats.max===-Number.MAX_VALUE&&(this.stats.max=null),this.stats.min===Number.MAX_VALUE&&(this.stats.min=null),c.length&&(this.stats.avg=this.stats.total/c.length,this.stats.current=c[c.length-1][1],null===this.stats.current&&c.length>1&&(this.stats.current=c[c.length-2][1])),c},c.prototype.updateLegendValues=function(a,b,c){this.valueFormater=a,this.decimals=b,this.scaledDecimals=c},c.prototype.formatValue=function(a){return this.valueFormater(a,this.decimals,this.scaledDecimals)},c});