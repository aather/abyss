/*! grafana - v2.5.0 - 2015-10-28
 * Copyright (c) 2015 Torkel Ã–degaard; Licensed Apache-2.0 */

define(["kbn","lodash","app/core/utils/datemath"],function(a,b,c){"use strict";function d(){var a=this;this.datasource={},this.$element={},this.annotationsSrv={},this.timeSrv=new g,this.templateSrv=new i,this.datasourceSrv={getMetricSources:function(){},get:function(){return{then:function(b){b(a.datasource)}}}},this.providePhase=function(c){return module(function(d){d.value("datasourceSrv",a.datasourceSrv),d.value("annotationsSrv",a.annotationsSrv),d.value("timeSrv",a.timeSrv),d.value("templateSrv",a.templateSrv),d.value("$element",a.$element),b.each(c,function(a,b){d.value(b,a)})})},this.createControllerPhase=function(b){return inject(function(c,d,e,g,h){a.scope=d.$new(),a.$location=g,a.$browser=h,a.scope.contextSrv={},a.scope.panel={},a.scope.row={panels:[]},a.scope.dashboard={},a.scope.dashboardMeta={},a.scope.dashboardViewState=new f,a.scope.appEvent=sinon.spy(),a.scope.onAppEvent=sinon.spy(),d.colors=[];for(var i=0;50>i;i++)d.colors.push("#"+i);a.$q=e,a.scope.skipDataOnInit=!0,a.scope.skipAutoInit=!0,a.controller=c(b,{$scope:a.scope})})}}function e(){var a=this;a.templateSrv=new i,a.timeSrv=new g,a.datasourceSrv={},a.backendSrv={},a.$location={},a.$routeParams={},this.providePhase=function(c){return module(function(d){b.each(c,function(b){d.value(b,a[b])})})},this.createService=function(b){return inject(function(c,d,e,f){a.$q=c,a.$rootScope=d,a.$httpBackend=e,a.$rootScope.onAppEvent=function(){},a.$rootScope.appEvent=function(){},a.service=f.get(b)})}}function f(){this.registerPanel=function(){}}function g(){this.init=sinon.spy(),this.time={from:"now-1h",to:"now"},this.timeRange=function(a){return a===!1?this.time:{from:c.parse(this.time.from,!1),to:c.parse(this.time.to,!0)}},this.replace=function(a){return a}}function h(){this.hasRole=function(){return!0}}function i(){this.variables=[],this.templateSettings={interpolate:/\[\[([\s\S]+?)\]\]/g},this.data={},this.replace=function(a){return b.template(a,this.data,this.templateSettings)},this.init=function(){},this.fillVariableValuesForUrl=function(){},this.updateTemplateData=function(){},this.variableExists=function(){return!1},this.highlightVariablesAsHtml=function(a){return a},this.setGrafanaVariable=function(a,b){this.data[a]=b}}return{ControllerTestContext:d,TimeSrvStub:g,ContextSrvStub:h,ServiceTestContext:e}});